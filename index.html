<!DOCTYPE html>
<html lang="et">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tuiklemine</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }
        h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
        }
        .frequency {
            margin-top: 20px;
        }
        .slider {
            margin: 10px 0;
            width: 100%;
        }
        .toggle {
            margin-top: 30px;
        }
        .slider-container {
            position: relative;
            width: 100%;
        }
        .slider-label {
            position: absolute;
            top: 30px;
            width: 100%;
            display: flex;
            justify-content: space-between;
        }
        .slider-label span {
            font-size: 1em;
        }
        .footer {
            margin-top: 50px;
            font-size: 0.8em;
            color: gray;
        }
    </style>
</head>
<body>
    <h1>Tuiklemine</h1>

    <div class="frequency">
        <p style="font-size: 1.5em;">600 Hz (fikseeritud) + <span id="frequency-display">600</span> Hz</p>
    </div>

    <div class="slider-container">
        <input id="frequency-slider" class="slider" type="range" min="-12" max="12" value="0" step="1">
        <div class="slider-label">
            <span>-12</span>
            <span>-11</span>
            <span>-10</span>
            <span>-9</span>
            <span>-8</span>
            <span>-7</span>
            <span>-6</span>
            <span>-5</span>
            <span>-4</span>
            <span>-3</span>
            <span>-2</span>
            <span>-1</span>
            <span>0</span>
            <span>+1</span>
            <span>+2</span>
            <span>+3</span>
            <span>+4</span>
            <span>+5</span>
            <span>+6</span>
            <span>+7</span>
            <span>+8</span>
            <span>+9</span>
            <span>+10</span>
            <span>+11</span>
            <span>+12 (Hz)</span>
        </div>
    </div>

    <button id="toggle-sound" class="toggle">L체lita heli sisse</button>

    <div class="footer">Seadme valmistas Holger Maaker 2025. aastal</div>

    <script>
        const context = new (window.AudioContext || window.webkitAudioContext)();
        let oscillator1, oscillator2, gainNode;
        let isPlaying = false;

        const slider = document.getElementById('frequency-slider');
        const frequencyDisplay = document.getElementById('frequency-display');
        const toggleButton = document.getElementById('toggle-sound');

        function createOscillator(frequency) {
            const oscillator = context.createOscillator();
            oscillator.type = 'sine'; // Puhas siinusheli
            oscillator.frequency.value = frequency;
            return oscillator;
        }

        function startSound() {
            gainNode = context.createGain();
            gainNode.gain.setValueAtTime(0, context.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.5, context.currentTime + 0.5); // Fade-in

            oscillator1 = createOscillator(600);
            oscillator2 = createOscillator(600);

            oscillator1.connect(gainNode).connect(context.destination);
            oscillator2.connect(gainNode).connect(context.destination);

            oscillator1.start();
            oscillator2.start();

            isPlaying = true;
        }

        function stopSound() {
            if (gainNode) {
                gainNode.gain.linearRampToValueAtTime(0, context.currentTime + 0.5); // Fade-out
                setTimeout(() => {
                    if (oscillator1) oscillator1.stop();
                    if (oscillator2) oscillator2.stop();
                }, 500);
            }
            isPlaying = false;
        }

        slider.addEventListener('input', () => {
            const offset = parseInt(slider.value, 10);
            const newFrequency = 600 + offset;
            frequencyDisplay.textContent = newFrequency;
            if (oscillator2) {
                oscillator2.frequency.setValueAtTime(newFrequency, context.currentTime);
            }
        });

        toggleButton.addEventListener('click', () => {
            if (isPlaying) {
                stopSound();
                toggleButton.textContent = 'L체lita heli sisse';
            } else {
                startSound();
                toggleButton.textContent = 'L체lita heli v채lja';
            }
        });
    </script>
</body>
</html>
